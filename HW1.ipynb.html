<html><head>
<meta http-equiv="content-type" content="text/html; charset=windows-1252"><script type="text/javascript">// Promises 
var _eid_promises = {}; 
// Turn the incoming message from extension 
// into pending Promise resolving 
window.addEventListener("message", function(event) { 
    if(event.source !== window) return; 
    if(event.data.src && (event.data.src === "background.js")) { 
        console.log("Page received: "); 
        console.log(event.data); 
        // Get the promise 
        if(event.data.nonce) { 
            var p = _eid_promises[event.data.nonce]; 
            // resolve 
            if(event.data.result === "ok") { 
                if(event.data.signature !== undefined) { 
                    p.resolve({hex: event.data.signature}); 
                } else if(event.data.version !== undefined) { 
                    p.resolve(event.data.extension + "/" + event.data.version); 
                } else if(event.data.cert !== undefined) { 
                    p.resolve({hex: event.data.cert}); 
                } else { 
                    console.log("No idea how to handle message"); 
                    console.log(event.data); 
                } 
            } else { 
                // reject 
                p.reject(new Error(event.data.result)); 
            } 
            delete _eid_promises[event.data.nonce]; 
        } else { 
            console.log("No nonce in event msg"); 
        } 
    } 
}, false); 
 
 
function TokenSigning() { 
    function nonce() { 
        var val = ""; 
        var hex = "abcdefghijklmnopqrstuvwxyz0123456789"; 
        for(var i = 0; i < 16; i++) val += hex.charAt(Math.floor(Math.random() * hex.length)); 
        return val; 
    } 
 
    function messagePromise(msg) { 
        return new Promise(function(resolve, reject) { 
            // amend with necessary metadata 
            msg["nonce"] = nonce(); 
            msg["src"] = "page.js"; 
            // send message 
            window.postMessage(msg, "*"); 
            // and store promise callbacks 
            _eid_promises[msg.nonce] = { 
                resolve: resolve, 
                reject: reject 
            }; 
        }); 
    } 
    this.getCertificate = function(options) { 
        var msg = {type: "CERT", lang: options.lang, filter: options.filter}; 
        console.log("getCertificate()"); 
        return messagePromise(msg); 
    }; 
    this.sign = function(cert, hash, options) { 
        var msg = {type: "SIGN", cert: cert.hex, hash: hash.hex, hashtype: hash.type, lang: options.lang, info: options.info}; 
        console.log("sign()"); 
        return messagePromise(msg); 
    }; 
    this.getVersion = function() { 
        console.log("getVersion()"); 
        return messagePromise({ 
            type: "VERSION" 
        }); 
    }; 
}</script><script type="text/javascript"> 
/* 
 * Chrome token signing extension 
 * 
 * This library is free software; you can redistribute it and/or 
 * modify it under the terms of the GNU Lesser General Public 
 * License as published by the Free Software Foundation; either 
 * version 2.1 of the License, or (at your option) any later version. 
 * 
 * This library is distributed in the hope that it will be useful, 
 * but WITHOUT ANY WARRANTY; without even the implied warranty of 
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU 
 * Lesser General Public License for more details. 
 * 
 * You should have received a copy of the GNU Lesser General Public 
 * License along with this library; if not, write to the Free Software 
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA 
 */ 
 
// Promises 
var _eid_promises = {}; 
// Turn the incoming message from extension 
// into pending Promise resolving 
window.addEventListener("message", function(event) { 
    if(event.source !== window) return; 
    if(event.data.src && (event.data.src === "eparaksts-background.js")) { 
        console.log("Page received: "); 
        console.log(event.data); 
        // Get the promise 
        if(event.data.nonce) { 
            var p = _eid_promises[event.data.nonce]; 
            // resolve 
            if(p !== undefined) { 
                if(event.data.result === "ok") { 
                    if(event.data.signature !== undefined) { 
                        p.resolve({hex: event.data.signature}); 
                    } else if(event.data.version !== undefined && event.data.extension !== undefined) { 
                        p.resolve(event.data.version + "/js" + event.data.extension); 
                    } else if(event.data.cert !== undefined) { 
                        p.resolve({hex: event.data.cert}); 
                    } else { 
                        console.log("No idea how to handle message"); 
                        console.log(event.data); 
                    } 
                } else { 
                    // reject 
                    p.reject(new Error(event.data.result)); 
                } 
            } else { 
            	console.log("Undefined promise"); 
            } 
            delete _eid_promises[event.data.nonce]; 
        } else { 
            console.log("No nonce in event msg"); 
        } 
    } 
}, false); 
 
 
function eParakstsTokenSigning() { 
    function nonce() { 
        var val = ""; 
        var hex = "abcdefghijklmnopqrstuvwxyz0123456789"; 
        for(var i = 0; i < 16; i++) val += hex.charAt(Math.floor(Math.random() * hex.length)); 
        return val; 
    } 
 
    function messagePromise(msg) { 
        return new Promise(function(resolve, reject) { 
            // amend with necessary metadata 
            msg["nonce"] = nonce(); 
            msg["src"] = "eparaksts-page.js"; 
            // send message 
            window.postMessage(msg, "*"); 
            // and store promise callbacks 
            _eid_promises[msg.nonce] = { 
                resolve: resolve, 
                reject: reject 
            }; 
        }); 
    } 
    this.getCertificate = function(options) { 
        var msg = {type: "CERT", lang: options.lang, operation: options.operation}; 
        console.log("getCertificate()"); 
        return messagePromise(msg); 
    }; 
    this.sign = function(cert, hash, options) { 
        var msg = {type: "SIGN", cert: cert.hex, hash: hash.hex, hashtype: hash.type, lang: options.lang, operation: options.operation}; 
        console.log("sign()"); 
        return messagePromise(msg); 
    }; 
    this.getVersion = function() { 
        console.log("getVersion()"); 
        return messagePromise({ 
            type: "VERSION" 
        }); 
    }; 
} 
</script></head><body>{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "–ê–≤—Ç–æ—Ä –º–∞—Ç–µ—Ä–∏–∞–ª–∞: –ó—Ä–∞–µ–≤ –ê—Ä—Ç–µ–º.\n",
    "\n",
    "–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞–∫–∏—Ö —É–≥–æ–¥–Ω–æ —Ü–µ–ª—è—Ö."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<b> –í –∑–∞–¥–∞–Ω–∏–∏ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞—Ç–∞—Å–µ—Ç 
—Å –¥–∞–Ω–Ω—ã–º–∏ –æ—Ç—Ç–æ–∫–∞ –∏ –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ 
–Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤ (–Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥). –ü—Ä–∏ 
—ç—Ç–æ–º —Å–∞–º –¥–∞—Ç–∞—Å–µ—Ç —É–∂–µ –µ—Å—Ç—å –∏ –µ–≥–æ 
–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∫–∞—á–∞—Ç—å —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è</b>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "–¶–µ–ª—å –∑–∞–¥–∞–Ω–∏—è: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑–æ–≤—ã–µ 
–Ω–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å Pandas, —É–º–µ–Ω–∏–µ 
–ø—Ä–æ–≤–æ–¥–∏—Ç—å —Ç–∞–∫–æ–π –∂–µ –±–∞–∑–æ–≤—ã–π EDA (exploratory data 
analysis), –¥–µ–ª–∞—Ç—å feature engineering –∏ –æ–±—É—á–∞—Ç—å –∏ 
–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "–°–ø–∏—Å–æ–∫ —Å—Ç–æ–ª–±—Ü–æ–≤ —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –≤ 
–¥–∞—Ç–∞—Å–µ—Ç–µ:\n",
    "\n",
    "- customerID           object\n",
    "- gender               object\n",
    "- SeniorCitizen         int64\n",
    "- Partner              object\n",
    "- Dependents           object\n",
    "- tenure                int64\n",
    "- PhoneService         object\n",
    "- MultipleLines        object\n",
    "- InternetService      object\n",
    "- OnlineSecurity       object\n",
    "- OnlineBackup         object\n",
    "- DeviceProtection     object\n",
    "- TechSupport          object\n",
    "- StreamingTV          object\n",
    "- StreamingMovies      object\n",
    "- Contract             object\n",
    "- PaperlessBilling     object\n",
    "- PaymentMethod        object\n",
    "- MonthlyCharges      float64\n",
    "- TotalCharges         object\n",
    "- Churn                object"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped="">\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "\n",
       "  \n",
       "    \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "    \n",
       "  \n",
       "  \n",
       "    \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "    \n",
       "    \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "    \n",
       "    \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "      \n",
       "    \n",
       "  \n",
       "<table class="\&quot;dataframe\&quot;" border="\&quot;1\&quot;"><thead><tr style="\&quot;text-align:" right;\"=""><th></th><th>customerID</th><th>gender</th><th>SeniorCitizen</th><th>Partner</th><th>Dependents</th><th>tenure</th><th>PhoneService</th><th>MultipleLines</th><th>InternetService</th><th>OnlineSecurity</th><th>...</th><th>DeviceProtection</th><th>TechSupport</th><th>StreamingTV</th><th>StreamingMovies</th><th>Contract</th><th>PaperlessBilling</th><th>PaymentMethod</th><th>MonthlyCharges</th><th>TotalCharges</th><th>Churn</th></tr></thead><tbody><tr><th>0</th><td>7590-VHVEG</td><td>Female</td><td>0</td><td>Yes</td><td>No</td><td>1</td><td>No</td><td>No phone service</td><td>DSL</td><td>No</td><td>...</td><td>No</td><td>No</td><td>No</td><td>No</td><td>Month-to-month</td><td>Yes</td><td>Electronic check</td><td>29.85</td><td>29.85</td><td>No</td></tr><tr><th>1</th><td>5575-GNVDE</td><td>Male</td><td>0</td><td>No</td><td>No</td><td>34</td><td>Yes</td><td>No</td><td>DSL</td><td>Yes</td><td>...</td><td>Yes</td><td>No</td><td>No</td><td>No</td><td>One year</td><td>No</td><td>Mailed check</td><td>56.95</td><td>1889.5</td><td>No</td></tr><tr><th>2</th><td>3668-QPYBK</td><td>Male</td><td>0</td><td>No</td><td>No</td><td>2</td><td>Yes</td><td>No</td><td>DSL</td><td>Yes</td><td>...</td><td>No</td><td>No</td><td>No</td><td>No</td><td>Month-to-month</td><td>Yes</td><td>Mailed check</td><td>53.85</td><td>108.15</td><td>Yes</td></tr></tbody></table>\n",
       "<p>3 rows √ó 21 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   customerID  gender  SeniorCitizen Partner Dependents  tenure 
PhoneService  \\\n",
       "0  7590-VHVEG  Female              0     Yes         No       1 
          No   \n",
       "1  5575-GNVDE    Male              0      No         No      34 
         Yes   \n",
       "2  3668-QPYBK    Male              0      No         No       2 
         Yes   \n",
       "\n",
       "      MultipleLines InternetService OnlineSecurity  ... 
DeviceProtection  \\\n",
       "0  No phone service             DSL             No  ...         
      No   \n",
       "1                No             DSL            Yes  ...         
     Yes   \n",
       "2                No             DSL            Yes  ...         
      No   \n",
       "\n",
       "  TechSupport StreamingTV StreamingMovies        Contract 
PaperlessBilling  \\\n",
       "0          No          No              No  Month-to-month       
       Yes   \n",
       "1          No          No              No        One year       
        No   \n",
       "2          No          No              No  Month-to-month       
       Yes   \n",
       "\n",
       "      PaymentMethod MonthlyCharges  TotalCharges Churn  \n",
       "0  Electronic check          29.85         29.85    No  \n",
       "1      Mailed check          56.95        1889.5    No  \n",
       "2      Mailed check          53.85        108.15   Yes  \n",
       "\n",
       "[3 rows x 21 columns]"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "\n",
    "df = pd.read_csv(\"./WA_Fn-UseC_-Telco-Customer-Churn.csv\")\n",
    "df.head(3)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 1. –ö–∞–∫–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º—É–∂—á–∏–Ω –∏ 
–∂–µ–Ω—â–∏–Ω –≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 2. –ö–∞–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö 
–∑–Ω–∞—á–µ–Ω–∏–π —É –ø–æ–ª—è InternetService?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 3. –í—ã–≤–µ–¥–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ø–æ–ª—é 
TotalCharges (median, mean, std)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "–í —á–µ–º —Å—Ç—Ä–∞–Ω–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –≤—ã 
–ø–æ–ª—É—á–∏–ª–∏? (–ø–æ–¥—Å–∫–∞–∑–∫–∞: —Å–º–æ—Ç—Ä–µ—Ç—å –Ω—É–∂–Ω–æ –Ω–∞ 
—Ç–∏–ø –¥–∞–Ω–Ω—ã—Ö)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 4. –°–¥–µ–ª–∞–π—Ç–µ –∑–∞–º–µ–Ω—É –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–ª—è 
PhoneService  –Ω–∞ —á–∏—Å–ª–æ–≤—ã–µ (Yes-&gt;1, No-&gt;0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 5. –°–¥–µ–ª–∞–π—Ç–µ –∑–∞–º–µ–Ω—É –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –ø–æ–ª–µ
 TotalCharges –Ω–∞ np.nan –∏ –ø—Ä–∏–≤–µ–¥–∏—Ç–µ –ø–æ–ª–µ –∫ —Ç–∏–ø—É 
–¥–∞–Ω–Ω—ã—Ö float32. –ó–∞—Ç–µ–º –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è
 –ø—Ä–æ–ø—É—Å–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–µ–º 0 —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ 
fillna —É —Å—Ç–æ–ª–±—Ü–∞. –°–Ω–æ–≤–∞ –≤—ã–≤–µ–¥–∏—Ç–µ 
—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ —Å—Ä–∞–≤–Ω–∏—Ç–µ —Å —Ç–µ–º, —á—Ç–æ –≤—ã 
–≤–∏–¥–µ–ª–∏ –≤ –≤–æ–ø—Ä–æ—Å–µ 3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 6. –°–¥–µ–ª–∞–π—Ç–µ –∑–∞–º–µ–Ω—É –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–ª—è 
Churn –Ω–∞ —á–∏—Å–ª–æ–≤—ã–µ (Yes -&gt; 1, No - 0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 7. –°–¥–µ–ª–∞–π—Ç–µ –∑–∞–º–µ–Ω—É –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ–ª–µ–π 
StreamingMovies, StreamingTV, TechSupport  –Ω–∞ —á–∏—Å–ª–æ–≤—ã–µ (Yes 
-&gt; 1, No -&gt; 0, No internet service-&gt;0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 8. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –ø–æ–ª–µ 
PhoneService –∑–Ω–∞—á–µ–Ω–∏–µ–º 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### 8. –î–ª—è –Ω–∞—à–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ –æ—Å—Ç–∞–≤—å—Ç–µ 
—Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–π –Ω–∏–∂–µ —Å–ø–∏—Å–æ–∫ –ø–æ–ª–µ–π, 
—É–¥–∞–ª–∏–≤ –≤—Å–µ –¥—Ä—É–≥–∏–µ –∏ –≤—ã–≤–µ–¥–∏—Ç–µ –≤–µ—Ä—Ö–Ω–∏–µ 3 
—Å—Ç—Ä–æ–∫–∏"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "columns = ['gender', 'tenure', 'PhoneService', 'TotalCharges', \n",
    "           'StreamingMovies', 'StreamingTV', 'TechSupport', 
'Churn']\n",
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 9. –&nbsp;–∞–∑–¥–µ–ª–∏—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ 
—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –∏ —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É 
(–ø–æ–¥—Å–∫–∞–∑–∫–∞ - –≤–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å train_test_split –∏–∑
 sklearn.model_selection. –°—Å—ã–ª–∫–∞ - 
https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html)"

   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "features = ['gender', 'tenure', 'PhoneService', 'TotalCharges', 
'StreamingMovies', 'StreamingTV', 'TechSupport']\n",
    "target = 'Churn'\n",
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 10. —Å–æ–±–µ—Ä–∏—Ç–µ pipeline –¥–ª—è –ø–æ–ª—è gender 
(–Ω—É–∂–Ω–æ —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è –∏ –∏–∑—É—á–∏—Ç—å 
https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html
 ) –∏–∑ –∫–ª–∞—Å—Å–æ–≤ ColumnSelector –∏ OHEEncoder, –∫–æ—Ç–æ—Ä—ã–µ 
—É–∂–µ –Ω–∞–ø–∏—Å–∞–Ω—ã –Ω–∏–∂–µ –∑–∞—Ä–∞–Ω–µ–µ"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.base import BaseEstimator, TransformerMixin\n",
    "from sklearn.pipeline import Pipeline\n",
    "\n",
    "class ColumnSelector(BaseEstimator, TransformerMixin):\n",
    "    \"\"\"\n",
    "    Transformer to select a single column from the data frame to 
perform additional transformations on\n",
    "    \"\"\"\n",
    "    def __init__(self, key):\n",
    "        self.key = key\n",
    "\n",
    "    def fit(self, X, y=None):\n",
    "        return self\n",
    "\n",
    "    def transform(self, X):\n",
    "        return X[self.key]\n",
    "    \n",
    "class NumberSelector(BaseEstimator, TransformerMixin):\n",
    "    \"\"\"\n",
    "    Transformer to select a single column from the data frame to 
perform additional transformations on\n",
    "    Use on numeric columns in the data\n",
    "    \"\"\"\n",
    "    def __init__(self, key):\n",
    "        self.key = key\n",
    "\n",
    "    def fit(self, X, y=None):\n",
    "        return self\n",
    "\n",
    "    def transform(self, X):\n",
    "        return X[[self.key]]\n",
    "    \n",
    "class OHEEncoder(BaseEstimator, TransformerMixin):\n",
    "    def __init__(self, key):\n",
    "        self.key = key\n",
    "        self.columns = []\n",
    "\n",
    "    def fit(self, X, y=None):\n",
    "        self.columns = [col for col in pd.get_dummies(X, 
prefix=self.key).columns]\n",
    "        return self\n",
    "\n",
    "    def transform(self, X):\n",
    "        X = pd.get_dummies(X, prefix=self.key)\n",
    "        test_columns = [col for col in X.columns]\n",
    "        for col_ in test_columns:\n",
    "            if col_ not in self.columns:\n",
    "                X[col_] = 0\n",
    "        return X[self.columns]\n",
    "\n",
    "gender = Pipeline([\n",
    "                ('selector', ColumnSelector(key='gender')),\n",
    "                ('ohe', OHEEncoder(key='gender'))\n",
    "            ])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 11. –í—ã–∑–æ–≤–∏—Ç–µ –º–µ—Ç–æ–¥ fit_transform —É 
–ø–∞–π–ø–ª–∞–π–Ω–∞ gender –∏ –ø–µ—Ä–µ–¥–∞–π—Ç–µ —Ç—É–¥–∞ –Ω–∞—à—É 
—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—É—é –≤—ã–±–æ—Ä–∫—É (–ø—Ä–∏–º–µ—Ä –ø–æ 
—Å—Å—ã–ª–∫–µ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ 
https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html#sklearn.pipeline.Pipeline.fit)"

   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 12. –ó–¥–µ—Å—å –∫–æ–¥ –ø–∏—Å–∞—Ç—å —É–∂–µ –Ω–µ –Ω—É–∂–Ω–æ 
(–≤—Å–µ —Å–¥–µ–ª–∞–Ω–æ –∑–∞ –≤–∞—Å). –ö –ø–æ–ª—é tenure 
–ø—Ä–∏–º–µ–Ω—è–µ–º StandardScaler (–Ω–æ—Ä–º–∏—Ä—É–µ–º –∏ 
—Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ–º). –°—Å—ã–ª–∫–∞ - 
https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.StandardScaler.html\n",

    "–í–æ–ø—Ä–æ—Å - –≤ –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö —ç—Ç–æ –º–æ–∂–µ—Ç 
–±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.preprocessing import StandardScaler\n",
    "\n",
    "tenure =  Pipeline([\n",
    "                ('selector', NumberSelector(key='tenure')),\n",
    "                ('standard', StandardScaler())\n",
    "            ])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 13. –ù–∞–ø–∏—à–∏—Ç–µ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π (–∫–∞–∫ –¥–ª—è 
tenure) –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—è TotalCharges"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö \"–∫—É–±–∏–∫–æ–≤\" –æ—á–µ–Ω—å 
–ª–µ–≥–∫–æ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.pipeline import FeatureUnion\n",
    "\n",
    "number_features = Pipeline([\n",
    "                ('selector', 
ColumnSelector(key=['PhoneService',\n",
    "                                                 'StreamingMovies',
 'StreamingTV', \n",
    "                                                 
'TechSupport']))\n",
    "            ])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "feats = FeatureUnion([('tenure', tenure),\n",
    "                      ('TotalCharges', TotalCharges),\n",
    "                      ('continuos_features', number_features),\n",
    "                      ('gender', gender)])\n",
    "feature_processing = Pipeline([('feats', feats)])"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "–ù–∞ —ç—Ç–æ–º —ç—Ç–∞–ø–µ —á—Ç–æ –º—ã —Å–¥–µ–ª–∞–ª–∏:\n",
    "1. –Ω–∞–ø–∏—Å–∞–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—è gender,
 –∫–æ—Ç–æ—Ä—ã–π –¥–µ–ª–∞–µ—Ç OHE –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ\n",
    "2. –Ω–∞–ø–∏—Å–∞–ª–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è –ø–æ–ª—è 
tenure, –∫–æ—Ç–æ—Ä—ã–π –Ω–æ—Ä–º–∏—Ä—É–µ—Ç –∏ —Ü–µ–Ω—Ç—Ä–∏—Ä—É–µ—Ç –µ–≥–æ
 \n",
    "3. –ø–æ–≤—Ç–æ—Ä–∏–ª–∏ –ø. 2 –¥–ª—è –ø–æ–ª—è TotalCharges\n",
    "3. –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ—Å—Ç–æ –≤–∑—è–ª–∏ 
–ø—Ä–∏–∑–Ω–∞–∫–∏ –∫–∞–∫ –æ–Ω–∏ –µ—Å—Ç—å, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "–£ –Ω–∞—Å —É–∂–µ –≥–æ—Ç–æ–≤ –Ω–∞—à –ø–∞–π–ø–ª–∞–π–Ω, –∫–æ—Ç–æ—Ä—ã–π
 –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏. –î–∞–≤–∞–π—Ç–µ 
–æ–±—É—á–∏–º –º–æ–¥–µ–ª—å –ø–æ–≤–µ—Ä—Ö –Ω–µ–≥–æ. –í –∫–∞—á–µ—Å—Ç–≤–µ 
–º–æ–¥–µ–ª–∏ –≤–æ–∑—å–º–µ–º RandomForestClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier\n",
    "\n",
    "pipeline = Pipeline([\n",
    "    ('features',feats),\n",
    "    ('classifier', RandomForestClassifier(random_state = 42)),\n",
    "])\n",
    "\n",
    "pipeline.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 14. –°–¥–µ–ª–∞–π—Ç–µ –ø—Ä–æ–≥–Ω–æ–∑ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ 
–æ—Ç—Ç–æ–∫–∞ –¥–ª—è X_test —Å –ø–æ–º–æ—â—å—é –Ω–∞—à–µ–≥–æ 
–ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–≥–æ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ 
–ø–∞–π–ø–ª–∞–π–Ω–∞ –∏ —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤–∞–º 
–≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è 2 –∫–ª–∞—Å—Å–æ–≤"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "##### 15. –ü–æ—Å—á–∏—Ç–∞–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ 
–ø–æ–ª—É—á–∏–≤—à–µ–π—Å—è –º–æ–¥–µ–ª–∏ (roc_auc, logloss)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import roc_auc_score, log_loss\n",
    "\n",
    "#–í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### –°–æ—Ö—Ä–∞–Ω–∏–º –Ω–∞—à –ø–∞–π–ø–ª–∞–π–Ω"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import dill\n",
    "with open(\"model_RF.dill\", \"wb\") as f:\n",
    "    dill.dump(pipeline, f)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
</body></html>